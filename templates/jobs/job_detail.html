{% extends 'base.html' %}
{# Fallback: using model helpers to avoid custom templatetag load issues #}
{% block title %}{{ job.title }}{% endblock %}
{% block content %}
<div class="row">
  <div class="col-lg-8">
    <div class="card shadow-sm mb-3 glass-card">
      <div class="card-body">
        <h2 class="card-title">{{ job.title }}</h2>
        <h5 class="text-muted">{{ job.company_name }}</h5>
        <div class="mb-2 muted"><i class="bi bi-geo-alt"></i> {{ job.location }}</div>
        <div class="mb-3 text-success"><i class="bi bi-cash-coin"></i> {{ job.get_salary_range }}</div>
        <div class="mb-2">
          {% for s in job.get_skill_list %}
            <span class="chip">{{ s }}</span>
          {% endfor %}
        </div>
        <p class="mt-3">{{ job.description|linebreaks }}</p>
      </div>
    </div>
  </div>
  <div class="col-lg-4">
    <div class="card shadow-sm glass-card">
      <div class="card-body">
        {% if user.is_authenticated and user.role == 'jobseeker' %}
          <form class="mb-3" method="post" action="{% url 'apply_job' job.pk %}" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="mb-2"><label class="form-label">Resume</label><input class="form-control" type="file" name="resume" /></div>
            <div class="mb-2"><label class="form-label">Cover Letter</label><textarea class="form-control" name="cover_letter" rows="5"></textarea></div>
            <button class="btn btn-primary w-100" type="submit">Apply</button>
          </form>
          <form method="post" action="{% url 'toggle_bookmark' job.pk %}">
            {% csrf_token %}
            <button class="btn btn-outline-secondary w-100" type="submit">{% if is_bookmarked %}Remove Bookmark{% else %}Save Job{% endif %}</button>
          </form>
        {% else %}
          <a class="btn btn-primary w-100" href="{% url 'login' %}">Login to Apply</a>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}


